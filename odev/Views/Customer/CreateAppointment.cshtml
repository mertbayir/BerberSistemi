@{
    Layout = "_LayoutCustomer.cshtml";
}

@model odev.Models.Appointment


<h2>Randevu Al</h2>

<form asp-action="CreateAppointment" method="post">
   
    @if (!ViewData.ModelState.IsValid)
    {
        <div class="alert alert-danger">
            <p>Seçtiğiniz Randevu Uygun Değildir</p>
        </div>
    }

    <div>
        <label>Berber Seçin:</label>
        <select id="Name" name="Name" required>
            <option value="" disabled selected>Berber Seçin</option>
            @foreach (var barber in ViewBag.Barbers)
            {
                <option value="@barber.Name">@barber.Name</option>
            }
        </select>
    </div>

    <div>
        <label>Hizmet Seçin:</label>
        <select id="Skills" name="Skills" required>
        </select>
    </div>

    <!-- Tarih Seçimi -->
    <div>
        <label>Tarih:</label>
        <input type="date" name="Date" required />
    </div>

    <!-- Saat Seçimi -->
    <div>
        <label>Saat:</label>
        <select name="Time" required>
            <option value="" disabled selected>Saat Seçin</option>
            <option value="09:00">09:00</option>
            <option value="10:30">10:30</option>
            <option value="12:00">12:00</option>
            <option value="14:00">14:00</option>
            <option value="15:30">15:30</option>
            <option value="17:00">17:00</option>
        </select>
    </div>

    <button type="submit">Randevu Oluştur</button>
</form>


<script>
    // Veritabanından gelen berber verilerini JavaScript'e aktarma
    var barbers = @Html.Raw(Json.Serialize(ViewBag.Barbers));

    // Konsola barbers verisini yazdırarak kontrol et
    console.log(barbers); // Burada konsolda barbers verisini inceleyin

    // Berber seçildiğinde hizmet listesini güncelleme
    document.getElementById("Name").addEventListener("change", function () {
        var selectedBarber = this.value;
        var skillsDropdown = document.getElementById("Skills");

        // Seçilen berberin verilerini bulma
        var selectedBarberData = barbers.find(function (barber) {
            return barber.Name === selectedBarber;
        });

        // Seçilen berberin verilerini kontrol etme
        console.log(selectedBarberData.skills); // Burada konsola seçilen berberin verisini yazdırarak kontrol edin


       
            var skills = barbers.Skills; // Hizmetleri virgülle ayırma
            console.log(barbers); // Hizmetleri konsolda kontrol et
    


            // Mevcut hizmet seçeneklerini temizleme
            skillsDropdown.innerHTML = "<option value='' disabled selected>Hizmet Seçin</option>";

            // Yeni hizmet seçeneklerini ekleme
           /* skills.forEach(function (skill) {
                var option = document.createElement("option");
                option.value = skill.trim(); // Hizmeti seçenek olarak ekle
                option.text = skill.trim();  // Hizmeti metin olarak ekle
                skillsDropdown.appendChild(option);
            });*/
      
    });
</script>